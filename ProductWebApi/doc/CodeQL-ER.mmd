---
title: CodeQL Code Scanning Entity Relationship Diagram
---
erDiagram
    REPOSITORY ||--o{ CODE_SCANNING_RUN : triggers
    CODE_SCANNING_RUN ||--o{ ALERT : generates
    ALERT }o--|| DEVELOPER : reviewed_by
    CODE_SCANNING_RUN }o--|| CODEQL_ENGINE : uses
    CODEQL_ENGINE ||--o{ QUERY : runs
    QUERY ||--o{ LANGUAGE : supports

    REPOSITORY {
        uuid id PK
        text name
        boolean is_public
        boolean advanced_security_enabled "GHAS enabled flag"
    }

    CODE_SCANNING_RUN {
        uuid id PK
        uuid repo_id FK
        text setup_type "default, advanced, external"
        timestamp triggered_at
        text event "push, pull_request, schedule"
        text status "completed, failed, in_progress"
    }

    ALERT {
        uuid id PK
        uuid scan_id FK
        text severity "critical, high, medium, low"
        text status "open, fixed, dismissed"
        text description
        text rule_id "CodeQL rule identifier"
        timestamp created_at
        timestamp closed_at
    }

    DEVELOPER {
        uuid id PK
        text username
        text email
        text role "admin, write, read"
    }

    CODEQL_ENGINE {
        uuid id PK
        text version "CodeQL CLI version"
        boolean uses_cli
        boolean uses_actions
        text database_language
    }

    QUERY {
        uuid id PK
        uuid engine_id FK
        text name
        text category "security, quality, maintainability"
        text severity_level "error, warning, note"
        boolean is_custom
    }

    LANGUAGE {
        uuid id PK
        text name "C++, C#, Go, Java, JavaScript, Python, Ruby, Swift"
        text type "compiled, interpreted"
        boolean is_supported
    }

    %% Define color classes for different entity types
    classDef repository fill:#e3f2fd,stroke:#1976d2,stroke-width:3px,color:#000
    classDef scanning fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px,color:#000
    classDef alert fill:#ffebee,stroke:#d32f2f,stroke-width:3px,color:#000
    classDef user fill:#e8f5e8,stroke:#388e3c,stroke-width:3px,color:#000
    classDef engine fill:#fff3e0,stroke:#f57c00,stroke-width:3px,color:#000
    classDef query fill:#fce4ec,stroke:#c2185b,stroke-width:3px,color:#000
    classDef language fill:#f1f8e9,stroke:#689f38,stroke-width:3px,color:#000

    %% Apply classes to entities
    class REPOSITORY repository
    class CODE_SCANNING_RUN scanning
    class ALERT alert
    class DEVELOPER user
    class CODEQL_ENGINE engine
    class QUERY query
    class LANGUAGE language
